<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('./partials/head') %> 
    <%- include('./partials/icon') %>

    <title>User Dashboard</title>
  </head>
  <body class="bg-gray-100 text-gray-900 font-sans">
    <%- include('./partials/nav') %>

    <div class="max-w-4xl mx-auto p-6 bg-white shadow-lg rounded-lg mt-10">
      <header class="text-center">
        <h1 class="text-3xl font-semibold text-blue-500">
          Welcome, <%= user.firstName %>!
        </h1>
      </header>

      <div class="mt-8 space-y-8">
        <section>
          <h2 class="text-xl font-semibold text-gray-800">
            Your Likes
            <span class="text-sm text-gray-500"
              >(<%= user.likes.length %>)</span
            >
          </h2>
          <button class="mt-2 text-blue-500" onclick="openModal('likesModal')">
            View Likes
          </button>
        </section>

        <section>
          <h2 class="text-xl font-semibold text-gray-800">
            Your Liked Animes
            <span class="text-sm text-gray-500"
              >(<%= user.liked.length %>)</span
            >
          </h2>
          <button class="mt-2 text-blue-500" onclick="openModal('likedModal')">
            View Liked Animes
          </button>
        </section>

        <section>
          <h2 class="text-xl font-semibold text-gray-800">
            Your Recent Views
            <span class="text-sm text-gray-500"
              >(<%= user.views.length %>)</span
            >
          </h2>
          <button class="mt-2 text-blue-500" onclick="openModal('viewsModal')">
            View Recent Views
          </button>
        </section>
      </div>

      <div
        id="likesModal"
        class="fixed inset-0 bg-gray-500 bg-opacity-75 z-50 hidden overflow-y-auto"
      >
        <div class="flex justify-center items-center min-h-screen">
          <div class="bg-white rounded-lg shadow-lg p-6 w-96 h-96">
            <h2 class="text-2xl font-semibold text-gray-800">Your Likes</h2>
            <ul class="mt-4 space-y-2 overflow-y-auto h-72">
              <% user.likes.forEach(function(like) { %>
              <li class="p-4 bg-gray-50 rounded-lg shadow hover:bg-blue-50">
                <a
                  href="/users/<%= like.username %>"
                  class="text-blue-500 font-medium hover:underline"
                >
                  <%= like.username %>
                </a>
              </li>
              <% }); %>
            </ul>
            <button
              onclick="closeModal('likesModal')"
              class="mt-4 w-full py-2 bg-blue-500 text-white rounded-lg"
            >
              Close
            </button>
          </div>
        </div>
      </div>

      <div
        id="likedModal"
        class="fixed inset-0 bg-gray-500 bg-opacity-75 z-50 hidden overflow-y-auto"
      >
        <div class="flex justify-center items-center min-h-screen">
          <div class="bg-white rounded-lg shadow-lg p-6 w-96 h-96">
            <h2 class="text-2xl font-semibold text-gray-800">
              Your Liked Animes
            </h2>
            <ul class="mt-4 space-y-2 overflow-y-auto h-72">
              <% user.liked.forEach(function(liked) { %>
              <li class="p-4 bg-gray-50 rounded-lg shadow hover:bg-blue-50">
                <a
                  href="/users/<%= liked.username %>"
                  class="text-blue-500 font-medium hover:underline"
                >
                  <%= liked.username %>
                </a>
              </li>
              <% }); %>
            </ul>
            <button
              onclick="closeModal('likedModal')"
              class="mt-4 w-full py-2 bg-blue-500 text-white rounded-lg"
            >
              Close
            </button>
          </div>
        </div>
      </div>

      <div
        id="viewsModal"
        class="fixed inset-0 bg-gray-500 bg-opacity-75 z-50 hidden overflow-y-auto"
      >
        <div class="flex justify-center items-center min-h-screen">
          <div class="bg-white rounded-lg shadow-lg p-6 w-96 h-96">
            <h2 class="text-2xl font-semibold text-gray-800">
              Your Recent Views
            </h2>
            <ul class="mt-4 space-y-2 overflow-y-auto h-72">
              <% user.views.forEach(function(view) { %>
              <li class="p-4 bg-gray-50 rounded-lg shadow hover:bg-blue-50">
                <a
                  href="/users/<%= view.username %>"
                  class="text-blue-500 font-medium hover:underline"
                >
                  <%= view.username %>
                </a>
              </li>
              <% }); %>
            </ul>
            <button
              onclick="closeModal('viewsModal')"
              class="mt-4 w-full py-2 bg-blue-500 text-white rounded-lg"
            >
              Close
            </button>
          </div>
        </div>
      </div>

      <footer class="mt-12 text-center text-sm text-gray-500">
        <p>
          Logged in as <%= user.firstName %> <%= user.middleName %> <%=
          user.lastName %>
        </p>
      </footer>
    </div>
    <script>
      function openModal(id) {
        document.getElementById(id).classList.remove("hidden");
      }

      function closeModal(id) {
        document.getElementById(id).classList.add("hidden");
      }
    </script>
  </body>
</html>
